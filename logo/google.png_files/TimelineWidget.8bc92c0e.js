
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="6433d061-47b6-54c9-a38b-ec5995d4e060")}catch(e){}}();
!function(){function $parcel$defineInteropFlag(e){Object.defineProperty(e,"__esModule",{value:!0,configurable:!0})}function $parcel$export(e,t,i,n){Object.defineProperty(e,t,{get:i,set:n,enumerable:!0,configurable:!0})}var $parcel$global="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},parcelRequire=$parcel$global.parcelRequire94c2,parcelRegister=parcelRequire.register;parcelRegister("cfQKF",function(module,exports){$parcel$defineInteropFlag(module.exports),$parcel$export(module.exports,"default",function(){return TimelineWidget});var $8FDil=parcelRequire("8FDil"),$kKVXh=parcelRequire("kKVXh"),$dogxk=parcelRequire("dogxk"),$aZgrU=parcelRequire("aZgrU"),$22UZT=parcelRequire("22UZT"),$5rc4Z=parcelRequire("5rc4Z"),$ciAPg=parcelRequire("ciAPg"),$eIjVp=parcelRequire("eIjVp"),$5T7Io=parcelRequire("5T7Io"),TimelineWidget=function(){function TimelineWidget(e,t,i){(0,$8FDil._)(this,TimelineWidget),this._init(e,t,i)}return(0,$kKVXh._)(TimelineWidget,[{key:"_init",value:function(e,t,i){var n,o,s,a,l,r,u;if(this._type=null,this._entityId=null,this._timelineId=null,this._alpha=100,this._border=!1,this._onclickActions=null,this._onclickToggleOnActions=null,this._onclickToggleOffActions=null,this._onshowActions=null,this._onhideActions=null,this._onenterKeyActions=null,this._onclosedActions=null,this._onmouseoverActions=null,this._onmouseoutActions=null,this._ontransitionDoneActions=null,this._showOnMouseHover=!1,this._arena=i,this._opts=(null===(n=this._arena)||void 0===n?void 0:n._opts)||{embedData:{},publicationData:{},playoutData:{}},this._widgetAriaLabel=null,this._savedStyles=null,this._onvalidationsucceededActions=null,this._onvalidationfailedActions=null,this._onAllWidgetsValidatedActions=null,this._onformsuccessActions=null,this._onformfailureActions=null,this._isCurrentlyShown=!1,this._localStorage=null,this._executer=null,this._boundTouchStart=!1,this._boundTouchEnd=!1,this._boundMouseDown=!1,this._boundMouseMove=!1,this._boundMouseUp=!1,this._boundMouseEnter=!1,this._boundMouseLeave=!1,this._boundKeyDown=!1,this._boundEnterKeyDown=!1,this._inpoint=null,this._outpoint=null,this._widthFromConfig=null,this._heightFromConfig=null,this._datafeeds={},this._dynamicPropertiesDict={},this._asyncDatasourceDispatches={},this.$immersionLayer=null,this.lastConfigForTranslation=null,this._onResizedBound=this._onResized.bind(this),this._onDatafeedLoadedBound=this._onDatafeedLoaded.bind(this),this._onDatafeedLoadFailedBound=this._onDatafeedLoadFailed.bind(this),this._onLocalStorageUpdatedBound=this._onLocalStorageUpdated.bind(this),this._onValidationSucceededBound=this._onValidationSucceeded.bind(this),this._onValidationFailedBound=this._onValidationFailed.bind(this),this._onAllWidgetsValidatedBound=this._onAllWidgetsValidated.bind(this),this._onFormSuccessBound=this._onFormSuccess.bind(this),this._onFormFailureBound=this._onFormFailure.bind(this),this._onTouchStartBound=this._onTouchStart.bind(this),this._onTouchEndBound=this._onTouchEnd.bind(this),this._onMouseDownBound=this._onMouseDown.bind(this),this._onMouseMoveBound=this._onMouseMove.bind(this),this._onMouseUpBound=this._onMouseUp.bind(this),this._onKeyDownBound=this._onKeyDown.bind(this),this._onMouseEnterBound=this._onMouseEnter.bind(this),this._onMouseLeaveBound=this._onMouseLeave.bind(this),this._onEnterKeyDownBound=this._onEnterKeyDown.bind(this),this._onCloseButtonClickedBound=this._onCloseButtonClicked.bind(this),this._currentStatesetName="default",this._currentStateName="default",this._usedStatesRef=this._getUsedStates(t),this._usedStates=Object.keys(this._usedStatesRef),this.$element=null,void 0!==e&&null!=e&&(this.$element=e,this.$element.css("position","absolute"),this.$element.css("display","none"),this.$element.css("border-color","white"),this.$element.css("border-style","solid"),this.$element.css("border-width",this._border?"1px":"0px"),this.$element.css("z-index","0"),this.$element.css("cursor","auto"),this.$element.css("font-size","0"),this.$element.css("line-height","0"),this.$wrapper=this.$element.closest(".bb_wrapper"),(!this.$wrapper||this.$wrapper.length<=0)&&(this.$wrapper=null)),this.$wrapper||(this.$wrapper=this._arena&&this._arena.$element.closest(".bb_wrapper")),(!this.$wrapper||this.$wrapper.length<=0)&&(this.$wrapper=null),this.$wrapper&&(void 0!==(null===(s=this._arena)||void 0===s?void 0:null===(o=s.instanceService)||void 0===o?void 0:o.getInstance("SharedDataService"))&&(this._sharedDataService=this._arena.instanceService.getInstance("SharedDataService")),void 0!==(null===(l=this._arena)||void 0===l?void 0:null===(a=l.instanceService)||void 0===a?void 0:a.getInstance("Executer"))&&(this._executer=this._arena.instanceService.getInstance("Executer")),void 0!==(null===(u=this._arena)||void 0===u?void 0:null===(r=u.instanceService)||void 0===r?void 0:r.getInstance("LocalStorage"))&&(this._localStorage=this._arena.instanceService.getInstance("LocalStorage")),this.$wrapper.on("bb_resized bb_content_resized bb_fullscreen_change",this._onResizedBound),this.$wrapper.on("bb_datafeed_loaded",this._onDatafeedLoadedBound),this.$wrapper.on("bb_datafeed_load_failed",this._onDatafeedLoadFailedBound),this.$wrapper.on("bb_localstorage_updated",this._onLocalStorageUpdatedBound)),!this._localStorage&&this.$element)try{this._localStorage=new $ciAPg.default(this.$wrapper,this._opts)}catch(e){}this.ignoreTimelineShow=!1,this.ignoreTimelineHide=!1,void 0!==t.widgetdefinitiontype&&(this._type=t.widgetdefinitiontype),void 0!==t.id&&(this._entityId=t.id),void 0!==t.timelineId&&(this._timelineId=t.timelineId),void 0!==t.useSession&&(this._useSession="true"===t.useSession||!0===t.useSession),void 0!==t.inpoint&&(this._inpoint=t.inpoint),void 0!==t.outpoint&&(this._outpoint=t.outpoint),this._initialConfigJSON=JSON.stringify(t),this._defaultStateConfig=this.update(TimelineWidget._getConfig(t))}},{key:"restoreInitialConfig",value:function(){if(this._initialConfigJSON){var e=TimelineWidget._getConfig(JSON.parse(this._initialConfigJSON));delete e.grouping,delete e.ignoreTimelineHide,delete e.ignoreTimelineShow,this.update(e)}}},{key:"exit",value:function(){if(this.$wrapper&&(this.$wrapper.off("bb_resized bb_content_resized bb_fullscreen_change",this._onResizedBound),this.$wrapper.off("bb_datafeed_loaded",this._onDatafeedLoadedBound),this.$wrapper.off("bb_datafeed_load_failed",this._onDatafeedLoadFailedBound),this.$wrapper.off("bb_localstorage_updated",this._onLocalStorageUpdatedBound)),this.$element){var e,t;this.$element.get(0).removeEventListener("touchstart",this._onTouchStartBound),this.$element.get(0).removeEventListener("touchend",this._onTouchEndBound),document.removeEventListener("touchend",this._onTouchEndBound),this.$element.off("mousedown",this._onMouseDownBound),this.$element.off("mousemove",this._onMouseMoveBound),this.$element.off("mouseup",this._onMouseUpBound),document.removeEventListener("mouseup",this._onMouseUpBound),this.$element.off("mouseenter",this._onMouseEnterBound),this.$element.off("mouseleave",this._onMouseLeaveBound),this.$element.off("keydown",this._onKeyDownBound),this.$element.off("keydown",this._onKeyDownBound),null===(e=this.$input)||void 0===e||e.off("keydown",this._onEnterKeyDownBound),this.$element.off("bb_validationsucceeded",this._onValidationSucceededBound),this.$element.off("bb_validationfailed",this._onValidationFailedBound),this.$element.off("bb_allwidgetsvalidated",this._onAllWidgetsValidatedBound),this.$element.off("bb_formsuccess",this._onFormSuccessBound),this.$element.off("bb_formfailure",this._onFormFailureBound),null===(t=this.$closeButton)||void 0===t||t.off("click",this._onCloseButtonClickedBound)}return null}},{key:"update",value:function(e){for(var t in void 0!==e.ignoreTimelineShow&&(this.ignoreTimelineShow="true"==e.ignoreTimelineShow),void 0!==e.ignoreTimelineHide&&(this.ignoreTimelineHide="true"==e.ignoreTimelineHide),e)if("widgetdefinitiontype"!=t&&"id"!=t&&"timelineId"!=t&&"ignoreTimelineShow"!=t&&"ignoreTimelineHide"!=t){var i;if("string"==typeof e[t]){e[t]=this._replaceMacroStrings(e[t]);var n=e[t].match(/dataSource:\{[^}]*\}/gm);if(null!=n)for(var o=0;o<n.length;o++)e[t]=e[t].replace(n[o],this._processDataSource(n[o]))}else e[t]&&("object"===(0,$aZgrU._)(e[t])&&e[t].datasource||e[t+"_dataSource"])&&(-1!==t.indexOf("_dataSource")&&(t=t.replace("_dataSource","")),i=(e[t+"_dataSource"]||e[t]).datasource,e[t+"_dataSource"]={datasource:i},i.sourceValue&&(i.sourceValue=this._replaceMacroStrings(i.sourceValue)),i.defaultValue&&(i.defaultValue=this._replaceMacroStrings(i.defaultValue)),e[t]=this._processDataSource_obj(i,t))}if(void 0!==e.cssclass&&""!=e.cssclass&&void 0!==this.$element&&null!=this.$element&&this.$element.addClass(e.cssclass),void 0!==e.aria_label&&(this._widgetAriaLabel=e.aria_label),void 0!==this.$element&&null!=this.$element){if(null!=this._entityId&&this.$element.attr("id","bb-tw-"+this._entityId),void 0!==e.width){var s=this._widthFromConfig=e.width.toString();s.indexOf("%")>=0?this.$element.css("width",s):this.$element.width(Math.round(s))}if(void 0!==e.height){var a=this._heightFromConfig=e.height.toString();a.indexOf("%")>=0?this.$element.css("height",a):"auto"==a||""==a?this.$element.css("height",a):this.$element.height(Math.round(a))}if(void 0!==e.xpos){var l=e.xpos.toString();l.indexOf("%")>=0?this.$element.css("left",l):this.$element.css("left",Math.round(l).toString()+"px")}if(void 0!==e.ypos){var r=e.ypos.toString();r.indexOf("%")>=0?this.$element.css("top",r):this.$element.css("top",Math.round(r).toString()+"px")}if(void 0!==e.ll_x&&void 0!==e.ll_y&&void 0!==e.lr_x&&void 0!==e.lr_y&&void 0!==e.ul_x&&void 0!==e.ul_y&&void 0!==e.ur_x&&void 0!==e.ur_y){this.lastConfigForTranslation=e;var u,c,d,h=this.getAbsoluteValueFromWidth(e.ll_x),f=this.getAbsoluteValueFromWidth(e.lr_x),_=this.getAbsoluteValueFromWidth(e.ul_x),v=this.getAbsoluteValueFromWidth(e.ur_x),g=this.getAbsoluteValueFromHeight(e.ll_y),p=this.getAbsoluteValueFromHeight(e.lr_y),m=this.getAbsoluteValueFromHeight(e.ul_y),y=this.getAbsoluteValueFromHeight(e.ur_y);c=null!=this._widthFromConfig?this._widthFromConfig.indexOf("%")>=0?this.getAbsoluteValueFromWidth(this._widthFromConfig):Math.round(s):this.$element.parent().width();var b=[{x:0,y:0},{x:0,y:d=null!=this._heightFromConfig&&"app"!=this._type?this._heightFromConfig.indexOf("%")>=0?this.getAbsoluteValueFromHeight(this._heightFromConfig):Math.round(a):this.$element.parent().height()},{x:c,y:0},{x:c,y:d}],w=[{x:_,y:m},{x:h,y:g},{x:v,y:y},{x:f,y:p}],k="";try{var S=[[b[0].x,b[0].y,1,0,0,0,-b[0].x*w[0].x,-b[0].y*w[0].x],[0,0,0,b[0].x,b[0].y,1,-b[0].x*w[0].y,-b[0].y*w[0].y],[b[1].x,b[1].y,1,0,0,0,-b[1].x*w[1].x,-b[1].y*w[1].x],[0,0,0,b[1].x,b[1].y,1,-b[1].x*w[1].y,-b[1].y*w[1].y],[b[2].x,b[2].y,1,0,0,0,-b[2].x*w[2].x,-b[2].y*w[2].x],[0,0,0,b[2].x,b[2].y,1,-b[2].x*w[2].y,-b[2].y*w[2].y],[b[3].x,b[3].y,1,0,0,0,-b[3].x*w[3].x,-b[3].y*w[3].x],[0,0,0,b[3].x,b[3].y,1,-b[3].x*w[3].y,-b[3].y*w[3].y]],A=(0,$eIjVp.default).inverse(S),$=[w[0].x,w[0].y,w[1].x,w[1].y,w[2].x,w[2].y,w[3].x,w[3].y],x=(0,$eIjVp.default).getColumn((0,$eIjVp.default).multiplyVector(A,$),0);u=[x[0],x[3],0,x[6],x[1],x[4],0,x[7],0,0,1,0,x[2],x[5],0,1],k+="matrix3d(".concat(u.join(", "),")")}catch(e){(0,$5rc4Z.default)("TimelineWidget: contrib sylvester catch error = "+e.message)}if(""!=k){this.$element.css("left","0%"),this.$element.css("top","0%"),this.$element.css("transform-origin","0px 0px 0px"),this.$element.css("transform",k),(void 0===this.$immersionLayer||null==this.$immersionLayer)&&(this.$element.wrap('<div class="bb-immersion" style="position:absolute; width:100%; height:100%; top:0; left:0;pointer-events:none;"></div>'),this.$immersionLayer=this.$element.parent());var D=this.getLinesIntersectionPoint(_,m,f,p,v,y,h,g);if(void 0!==this.previousMiddlePoint&&null!=this.previousMiddlePoint&&null!=D.x&&null!=D.y){var T=Math.sqrt(Math.pow(this.previousMiddlePoint.x-D.x,2)+Math.pow(D.y-D.y,2)),V=this.$immersionLayer.height()/800,I=this.$immersionLayer.height()/1100,C=T>V?V:T;C>0?(this.$immersionLayer.css("-webkit-filter","blur("+C+"px)"),this.$immersionLayer.css("filter","blur("+C+"px)")):(this.$immersionLayer.css("-webkit-filter","blur("+I+"px)"),this.$immersionLayer.css("filter","blur("+I+"px)"))}this.previousMiddlePoint=D}}if(void 0!==e.color&&this.$element.children().css("background-color","#"+e.color),void 0!==e.alpha&&(this._alpha=e.alpha,this.$element.children().css("opacity",parseFloat(this._alpha)/100)),void 0!==e.border&&(this._border="true"==e.border,this.$element.css("border-width",this._border?"1px":"0px")),void 0!==e.onclick&&(e.onclick?this._onclickActions="string"==typeof e.onclick?e.onclick.split("\n"):e.onclick.actions||e.onclick:this._onclickActions=null,this._onclickActions&&this._onclickActions.length>0&&(this.$element.css("cursor","pointer"),this._bindClickAndTouch())),void 0!==e.onenter&&(e.onenter?this._onenterKeyActions="string"==typeof e.onenter?e.onenter.split("\n"):e.onenter.actions||e.onenter:this._onenterKeyActions=null,this._onenterKeyActions&&this._onenterKeyActions.length>0&&this._bindEnterKeyDown()),void 0!==e.imageid_toggle&&e.imageid_toggle&&this._bindClickAndTouch(),void 0!==e.onclickToggleOn&&(e.onclickToggleOn?this._onclickToggleOnActions="string"==typeof e.onclickToggleOn?e.onclickToggleOn.split("\n"):e.onclickToggleOn.actions||e.onclickToggleOn:this._onclickToggleOnActions=null,this._onclickToggleOnActions&&this._onclickToggleOnActions.length>0&&(this.$element.css("cursor","pointer"),this._bindClickAndTouch())),void 0!==e.onclickToggleOff&&(e.onclickToggleOff?this._onclickToggleOffActions="string"==typeof e.onclickToggleOff?e.onclickToggleOff.split("\n"):e.onclickToggleOff.actions||e.onclickToggleOff:this._onclickToggleOffActions=null,this._onclickToggleOffActions&&this._onclickToggleOffActions.length>0&&(this.$element.css("cursor","pointer"),this._bindClickAndTouch())),void 0!==e.onmouseover&&(e.onmouseover?this._onmouseoverActions="string"==typeof e.onmouseover?e.onmouseover.split("\n"):e.onmouseover.actions||e.onmouseover:this._onmouseoverActions=null,this._onmouseoverActions&&this._onmouseoverActions.length>0?(this._bindEnterAndLeave(),this._bindClickAndTouch()):this._usedStatesRef.mouseover&&(this._bindEnterAndLeave(),this._bindClickAndTouch())),void 0!==e.onmouseout&&(e.onmouseout?this._onmouseoutActions="string"==typeof e.onmouseout?e.onmouseout.split("\n"):e.onmouseout.actions||e.onmouseout:this._onmouseoutActions=null,this._onmouseoutActions&&this._onmouseoutActions.length>0&&(this._bindEnterAndLeave(),this._bindClickAndTouch())),void 0!==e.onvalidationsucceeded&&(e.onvalidationsucceeded?this._onvalidationsucceededActions="string"==typeof e.onvalidationsucceeded?e.onvalidationsucceeded.split("\n"):e.onvalidationsucceeded.actions||e.onvalidationsucceeded:this._onvalidationsucceededActions=null,this._onvalidationsucceededActions&&this._onvalidationsucceededActions.length>0&&this.$element.on("bb_validationsucceeded",this._onValidationSucceededBound)),void 0!==e.onvalidationfailed&&(e.onvalidationfailed?this._onvalidationfailedActions="string"==typeof e.onvalidationfailed?e.onvalidationfailed.split("\n"):e.onvalidationfailed.actions||e.onvalidationfailed:this._onvalidationfailedActions=null,this._onvalidationfailedActions&&this._onvalidationfailedActions.length>0&&this.$element.on("bb_validationfailed",this._onValidationFailedBound)),void 0!==e.onAllWidgetsValidated&&(e.onAllWidgetsValidated?this._onAllWidgetsValidatedActions="string"==typeof e.onAllWidgetsValidated?e.onAllWidgetsValidated.split("\n"):e.onAllWidgetsValidated.actions||e.onAllWidgetsValidated:this._onAllWidgetsValidatedActions=null,this._onAllWidgetsValidatedActions&&this._onAllWidgetsValidatedActions.length>0&&this.$element.on("bb_allwidgetsvalidated",this._onAllWidgetsValidatedBound)),void 0!==e.onSuccess&&(e.onSuccess?this._onformsuccessActions="string"==typeof e.onSuccess?e.onSuccess.split("\n"):e.onSuccess.actions||e.onSuccess:this._onformsuccessActions=null,this._onformsuccessActions&&this._onformsuccessActions.length>0&&this.$element.on("bb_formsuccess",this._onFormSuccessBound)),void 0!==e.onFailure&&(e.onFailure?this._onformfailureActions="string"==typeof e.onFailure?e.onFailure.split("\n"):e.onFailure.actions||e.onFailure:this._onformfailureActions=null,this._onformfailureActions&&this._onformfailureActions.length>0&&this.$element.on("bb_formfailure",this._onFormFailureBound)),void 0!==e.ontransitionDone&&(e.ontransitionDone?this._ontransitionDoneActions="string"==typeof e.ontransitionDone?e.ontransitionDone.split("\n"):e.ontransitionDone.actions||e.ontransitionDone:this._ontransitionDoneActions=null),void 0!==e.showOnMouseHover&&(this._showOnMouseHover="true"==e.showOnMouseHover,this._showOnMouseHover&&(this._bindEnterAndLeave(),this._bindClickAndTouch(),this.$element.css("border-width","0px"),this.$element.children().css("opacity","0.0"))),void 0!==e.showCloseButton&&"true"==e.showCloseButton&&(this.$closeButton=(0,$22UZT.default)('<button style="position:absolute;right:0px;top:0px;background:#eee;height:16px;width:16px;margin:0;padding:0;line-height:8px;cursor:pointer;z-index:2;" title="close">X</button>'),this.$closeButton.on("click",this._onCloseButtonClickedBound),this.$element.append(this.$closeButton)),void 0!==e.grouping){var M="string"==typeof e.grouping?e.grouping.split("\n"):e.grouping.groups||e.grouping;if((void 0===M?"undefined":(0,$aZgrU._)(M))==="array"||(void 0===M?"undefined":(0,$aZgrU._)(M))==="object")for(var o in M)parseInt(o)>=0&&this._arena.getGroupById(M[o]).addMember(this)}}void 0!==e.onshow&&(e.onshow?this._onshowActions="string"==typeof e.onshow?e.onshow.split("\n"):e.onshow.actions||e.onshow:this._onshowActions=null),void 0!==e.onhide&&(e.onhide?this._onhideActions="string"==typeof e.onhide?e.onhide.split("\n"):e.onhide.actions||e.onhide:this._onhideActions=null),void 0!==e.onclosed&&(e.onclosed?this._onclosedActions="string"==typeof e.onclosed?e.onclosed.split("\n"):e.onclosed.actions||e.onclosed:this._onclosedActions=null),null!=this.$element&&(null!=this._onclickActions&&this._onclickActions.length>0||null!=this._onclickToggleOffActions&&this._onclickToggleOffActions.length>0||null!=this._onclickToggleOnActions&&this._onclickToggleOnActions.length>0)&&(this.$element.attr("role","button"),this._widgetAriaLabel||0===this._widgetAriaLabel?this.$element.attr("aria-label",this._widgetAriaLabel):this.$element.removeAttr("aria-label"),this.$element.attr("tabindex",0))}},{key:"show",value:function(){if(!this._isCurrentlyShown&&(this._isCurrentlyShown=!0,void 0!==this.$element&&null!=this.$element&&("image"==this._type&&this.$element.css("visibility","visible").children("img").show(),"video"==this._type&&this.$element.css({marginLeft:"0"}),this.$element.show(),"function"==typeof this.resume&&this.resume(),"function"==typeof this.showWidgets&&this.showWidgets(),this.$element.trigger("bb_widget_shown",[{entityId:this._entityId,timelineId:this._timelineId}])),"array"===(0,$aZgrU._)(this._onshowActions)||"object"===(0,$aZgrU._)(this._onshowActions)))for(var e in this._onshowActions)parseInt(e)>=0&&this._handleAction(this._onshowActions[e])}},{key:"hide",value:function(){if(this._isCurrentlyShown){if(this._isCurrentlyShown=!1,void 0!==this.$element&&null!=this.$element&&((0,$5rc4Z.default)("TimelineWidget: hide: this.$element is OK"),"image"==this._type?this.$element.css("visibility","hidden").children("img").hide():"video"==this._type?this.$element.css({marginLeft:"-10000px"}):this.$element.hide(),"function"==typeof this.pause&&this.pause(),"function"==typeof this.hideWidgets&&this.hideWidgets()),"array"===(0,$aZgrU._)(this._onhideActions)||"object"===(0,$aZgrU._)(this._onhideActions))for(var e in this._onhideActions)parseInt(e)>=0&&this._handleAction(this._onhideActions[e]);this._updateWidgetState(null,"default")}}},{key:"getEntityId",value:function(){return this._entityId}},{key:"getTimelineId",value:function(){return this._timelineId}},{key:"getOnshowActions",value:function(){return this._onshowActions}},{key:"getOnhideActions",value:function(){return this._onhideActions}},{key:"getOnclickActions",value:function(){return this._onclickActions}},{key:"getOntransitionDoneActions",value:function(){return this._ontransitionDoneActions}},{key:"_getUsedStates",value:function(e){for(var t,i={},n=0;n<(null==e?void 0:null===(t=e.statesets)||void 0===t?void 0:t.length);n++)for(var o=e.statesets[n],s=0;s<o.states.length;s++){var a=o.states[s];Object.keys(null==a?void 0:a.config).length&&(i[a.name]=!0)}return i}},{key:"_bindClickAndTouch",value:function(){this.$element&&(this._boundTouchStart||(this._boundTouchStart=!0,this.$element.get(0).addEventListener("touchstart",this._onTouchStartBound,{passive:!0})),this._boundTouchEnd||(this._boundTouchEnd=!0,this.$element.get(0).addEventListener("touchend",this._onTouchEndBound,{passive:!0}),document.addEventListener("touchend",this._onTouchEndBound,{passive:!0})),this._boundMouseDown||(this._boundMouseDown=!0,this.$element.on("mousedown",this._onMouseDownBound)),this._boundMouseMove||(this._boundMouseMove=!0,this.$element.on("mousemove",this._onMouseMoveBound)),this._boundMouseUp||(this._boundMouseUp=!0,this.$element.on("mouseup",this._onMouseUpBound),document.addEventListener("mouseup",this._onMouseUpBound)),this._boundKeyDown||(this._boundKeyDown=!0,this.$element.on("keydown",this._onKeyDownBound)))}},{key:"_bindEnterAndLeave",value:function(){this.$element&&(this._boundMouseEnter||(this._boundMouseEnter=!0,this.$element.on("mouseenter",this._onMouseEnterBound)),this._boundMouseLeave||(this._boundMouseLeave=!0,this.$element.on("mouseleave",this._onMouseLeaveBound)))}},{key:"_bindEnterKeyDown",value:function(){this.$element&&(this.$input=this.$element.find("input, textarea"),this.$input.length<=0&&(this.$input=null),null==this.$input||this._boundEnterKeyDown||(this._boundEnterKeyDown=!0,this.$input.on("keydown",this._onEnterKeyDownBound)))}},{key:"_onKeyDown",value:function(e){e&&void 0!==e.key&&"Enter"===e.key&&(this._onMouseDown(e),this._onMouseUp(e))}},{key:"_onEnterKeyDown",value:function(e){if(e&&void 0!==e.key&&"Enter"===e.key&&this._isCurrentlyShown&&("array"===(0,$aZgrU._)(this._onenterKeyActions)||"object"===(0,$aZgrU._)(this._onenterKeyActions)))for(var t in this._onenterKeyActions)parseInt(t)>=0&&this._handleAction(this._onenterKeyActions[t])}},{key:"_onMouseDown",value:function(e){this._isTouch&&this._boundMouseEnter&&this._onMouseEnter(e),(0,$5rc4Z.default)("[TimelineWidget:"+this._entityId+"] _onMouseDown"),this._mouseDown||(this._mouseDown=!0,this._mouseDownTarget=e.target)}},{key:"_onMouseMove",value:function(e){this._mouseDown&&((0,$5rc4Z.default)("[TimelineWidget:"+this._entityId+"] _onMouseMove while mouse down"),e.preventDefault())}},{key:"_onMouseUp",value:function(e){if((0,$5rc4Z.default)("[TimelineWidget:"+this._entityId+"] _onMouseUp"),this._mouseDown&&(this._mouseDown=!1,e.target===this._mouseDownTarget&&(this._mouseDownTarget=null,(0,$5rc4Z.default)("[TimelineWidget:"+this._entityId+"] _onMouseUp correct target"),this._isCurrentlyShown))){if(null===(i=this.$element)||void 0===i||i.trigger("bb_widget_clicked",[{entityId:this._entityId,timelineId:this._timelineId}]),"array"===(0,$aZgrU._)(this._onclickActions)||"object"===(0,$aZgrU._)(this._onclickActions))for(var t in this._onclickActions)parseInt(t)>=0&&this._handleAction(this._onclickActions[t]);var i,n=!1;if("function"==typeof this.toggleContent&&"function"==typeof this.getToggleState){if(n=this.getToggleState(),this.toggleContent(),n){if("array"===(0,$aZgrU._)(this._onclickToggleOnActions)||"object"===(0,$aZgrU._)(this._onclickToggleOnActions))for(var t in this._onclickToggleOnActions)parseInt(t)>=0&&this._handleAction(this._onclickToggleOnActions[t])}else if("array"===(0,$aZgrU._)(this._onclickToggleOffActions)||"object"===(0,$aZgrU._)(this._onclickToggleOffActions))for(var t in this._onclickToggleOffActions)parseInt(t)>=0&&this._handleAction(this._onclickToggleOffActions[t])}}if(this._isTouch&&this._boundMouseLeave){var o=this;window.setTimeout(function(){o._onMouseLeave(e)},40)}}},{key:"_onCloseButtonClicked",value:function(e){if(this._isCurrentlyShown&&(this.hide(),"array"===(0,$aZgrU._)(this._onclosedActions)||"object"===(0,$aZgrU._)(this._onclosedActions)))for(var t in this._onclosedActions)parseInt(t)>=0&&this._handleAction(this._onclosedActions[t])}},{key:"_onMouseEnter",value:function(e){if((0,$5rc4Z.default)("[TimelineWidget:"+this._entityId+"] _onMouseEnter"),!this._mouseEnter&&(this._mouseEnter=!0,(0,$5rc4Z.default)("[TimelineWidget:"+this._entityId+"] _onMouseEnter while left"),this._isCurrentlyShown)){if(this._showOnMouseHover){var t,i;null===(t=this.$element)||void 0===t||t.css("border-width",this._border?"1px":"0px"),null===(i=this.$element)||void 0===i||i.children().css("opacity",parseFloat(this._alpha)/100)}if("array"===(0,$aZgrU._)(this._onmouseoverActions)||"object"===(0,$aZgrU._)(this._onmouseoverActions))for(var n in this._onmouseoverActions)parseInt(n)>=0&&this._handleAction(this._onmouseoverActions[n],this._isTouch);this._updateWidgetState(null,"mouseover")}}},{key:"_updateWidgetState",value:function(e,t){if("image"!==this._type){e&&this._currentStatesetName!==e&&(this._currentStatesetName=e),t&&this._currentStateName!==t&&(this._currentStateName=t);var i=TimelineWidget._getConfig(JSON.parse(this._initialConfigJSON),this._currentStatesetName,this._currentStateName);this.update(i)}}},{key:"_onTouchStart",value:function(e,t){this._isTouch=!0,t&&t.ignore||this._touchStart||(this._touchStart=!0,e.stopPropagation(),(0,$22UZT.default)(e.target).trigger(e.type,[{ignore:!0}]))}},{key:"_onTouchEnd",value:function(e,t){this._isTouch=!0,t&&t.ignore||!this._touchStart||(this._touchStart=!1,e.stopPropagation(),(0,$22UZT.default)(e.target).trigger(e.type,[{ignore:!0}]))}},{key:"_onMouseLeave",value:function(e){if((0,$5rc4Z.default)("[TimelineWidget:"+this._entityId+"] _onMouseLeave"),this._mouseEnter&&(this._mouseEnter=!1,(0,$5rc4Z.default)("[TimelineWidget:"+this._entityId+"] _onMouseLeave while entered"),this._isCurrentlyShown)){if(this._showOnMouseHover){var t,i;null===(t=this.$element)||void 0===t||t.css("border-width","0px"),null===(i=this.$element)||void 0===i||i.children().css("opacity","0.0")}if("array"===(0,$aZgrU._)(this._onmouseoutActions)||"object"===(0,$aZgrU._)(this._onmouseoutActions))for(var n in this._onmouseoutActions)parseInt(n)>=0&&this._handleAction(this._onmouseoutActions[n],this._isTouch);this._updateWidgetState(null,"default")}}},{key:"_onValidationSucceeded",value:function(e){if((0,$5rc4Z.default)("_onValidationSucceeded"),"array"===(0,$aZgrU._)(this._onvalidationsucceededActions)||"object"===(0,$aZgrU._)(this._onvalidationsucceededActions))for(var t in this._onvalidationsucceededActions)parseInt(t)>=0&&this._handleAction(this._onvalidationsucceededActions[t])}},{key:"_onValidationFailed",value:function(e){if("array"===(0,$aZgrU._)(this._onvalidationfailedActions)||"object"===(0,$aZgrU._)(this._onvalidationfailedActions))for(var t in this._onvalidationfailedActions)parseInt(t)>=0&&this._handleAction(this._onvalidationfailedActions[t])}},{key:"_onAllWidgetsValidated",value:function(e){if("array"===(0,$aZgrU._)(this._onAllWidgetsValidatedActions)||"object"===(0,$aZgrU._)(this._onAllWidgetsValidatedActions))for(var t in this._onAllWidgetsValidatedActions)parseInt(t)>=0&&this._handleAction(this._onAllWidgetsValidatedActions[t])}},{key:"_onFormSuccess",value:function(e){if("array"===(0,$aZgrU._)(this._onformsuccessActions)||"object"===(0,$aZgrU._)(this._onformsuccessActions))for(var t in this._onformsuccessActions)parseInt(t)>=0&&this._handleAction(this._onformsuccessActions[t])}},{key:"_onFormFailure",value:function(e){if("array"===(0,$aZgrU._)(this._onformfailureActions)||"object"===(0,$aZgrU._)(this._onformfailureActions))for(var t in this._onformfailureActions)parseInt(t)>=0&&this._handleAction(this._onformfailureActions[t])}},{key:"_processDataSource",value:function(e){var t=!1;if(e){var i=null;if("string"==typeof e)try{i=JSON.parse((0,$22UZT.default).trim(e.replace(/^dataSource:/i,"")))}catch(e){i=null}else i={sourceType:e.sourceType,sourceValue:this._replaceMacroStrings(e.sourceValue),defaultValue:this._replaceMacroStrings(e.defaultValue)};t=this._processDataSource_obj(i)}return t}},{key:"_filterDatafeed",value:function(e){var t=this,i=[];if(e&&e.columns&&e.rows){i=e.rows;var n=e.columns.filter(function(e){return e&&"condition"===e.headerType&&e.key}).map(function(e){return e.key});n&&n.length&&(i=e.rows.filter(function(e){var i=!0;return n.forEach(function(n){if(i){var o=t._localStorage.get("bbtl_"+n),s=e[n],a=s;if((void 0===s?"undefined":(0,$aZgrU._)(s))==="object")switch(a=s.value,s.operator){case"is":case"isNot":i=o===a||String(o).toLowerCase()===String(a).toLowerCase(),"isNot"===s.operator&&(i=!i);break;case">":i=parseFloat(o)>parseFloat(a);break;case"<":i=parseFloat(o)<parseFloat(a);break;case"defined":case"undefined":i=null!=o,"undefined"===s.operator&&(i=!i);break;case"doesNotContain":case"contains":i=o&&o.toLowerCase&&a&&a.toLowerCase&&-1!==o.toLowerCase().indexOf(a.toLowerCase()),"doesNotContain"===s.operator&&(i=!i)}else void 0!==a&&(i=o===a||String(o).toLowerCase()===String(a).toLowerCase())}}),i}))}return i}},{key:"_onDatafeedLoaded",value:function(e,t){var i=this;t&&t.datafeed&&t.datafeed.id&&(this._datafeeds[t.datafeed.id]=t.datafeed,this._updateDatafeedProps(),this._asyncDatasourceDispatches[t.datafeed.id]&&this._asyncDatasourceDispatches[t.datafeed.id].length&&(this._asyncDatasourceDispatches[t.datafeed.id].forEach(function(e){i._handleAction_dispatch(e)}),delete this._asyncDatasourceDispatches[t.datafeed.id]))}},{key:"_onDatafeedLoadFailed",value:function(e,t){var i=this;t&&t.id&&(delete this._datafeeds[t.id],i._asyncDatasourceDispatches[t.id]&&i._asyncDatasourceDispatches[t.id].length&&(i._asyncDatasourceDispatches[t.id].forEach(function(e){i._handleAction_dispatch(e)}),delete i._asyncDatasourceDispatches[t.id]))}},{key:"_onLocalStorageUpdated",value:function(e,t){this._updateDatafeedProps()}},{key:"_updateDatafeedProps",value:function(e){if(this._dynamicPropertiesDict){var t=JSON.stringify(this._dynamicPropertiesDict);"{}"!==t&&this.update(JSON.parse(t))}}},{key:"_fetchDatafeed",value:function(e){var t=this.$wrapper;if(!this._datafeeds[e]&&(this._datafeeds[e]={},this._opts.publicationData.server&&e)){var i=this._opts.publicationData.server+"/sapi/datafeed/"+e;(0,$5T7Io.fetchData)(i).then(function(i){i?t&&t.trigger("bb_datafeed_loaded",[{datafeed:i}]):(console.warn("error fetching datafeed","no data"),t&&t.trigger("bb_datafeed_load_failed",[{id:e}]))}).catch(function(i){console.warn("error fetching datafeed",i),t&&t.trigger("bb_datafeed_load_failed",[{id:e}])})}}},{key:"_processDataSource_obj",value:function(e,t){var i="";if(null!=e&&void 0!==e.sourceType&&void 0!==e.sourceValue){if("JavaScript"==e.sourceType&&""!=e.sourceValue&&null!=this._executer&&"function"==typeof this._executer.execute){var n=this._executer.execute(e.sourceValue);void 0!==n?i=n:void 0!==e.defaultValue&&(i=String(e.defaultValue))}else if("QueryString"==e.sourceType&&""!=e.sourceValue){if(this._opts.joinedRequestParams){var o,s=this._opts.joinedRequestParams[String(e.sourceValue)];if(null!=s&&void 0!==s&&""!=s){try{var a=atob(s),l=Uint8Array.from(a,function(e){return e.codePointAt(0)});o=new TextDecoder().decode(l)}catch(e){}i=s.length%4==0&&null!=o&&void 0!==o?o:s}else void 0!==e.defaultValue&&null!=e.defaultValue&&(i=String(e.defaultValue))}}else if("LocalStorage"==e.sourceType&&""!=e.sourceValue){if(this._localStorage){var r=this._localStorage.get("bbtl_"+e.sourceValue);void 0!==r&&null!=r?i=r:void 0!==e.defaultValue&&null!=e.defaultValue&&(i=String(e.defaultValue))}}else if("PlainText"==e.sourceType)void 0!==e.sourceValue&&null!=e.sourceValue&&""!=e.sourceValue?i=e.sourceValue:void 0!==e.defaultValue&&null!=e.defaultValue&&(i=String(e.defaultValue));else if("DatafeedValue"==e.sourceType&&""!=e.sourceValue){if(void 0!==e.sourceValue&&null!=e.sourceValue){var u=e.sourceValue.split(":");if(2==u.length&&null!=u[0]&&void 0!==u[0]&&null!=u[1]&&void 0!==u[1]){var c=u[0],d=u[1];if(t&&(this._dynamicPropertiesDict[t]={datasource:e}),this._datafeeds[c]){var h=this._datafeeds[c],f=this._filterDatafeed(h);if(f&&f.length){var _="true"===h.randomRowSelection||!0===h.randomRowSelection?Math.floor(Math.random()*f.length):0;void 0!==f[_][d]&&(i=String(f[_][d]))}else i=void 0!==e.defaultValue&&null!=e.defaultValue?String(e.defaultValue):""}else this._fetchDatafeed(c),i=void 0!==e.defaultValue&&null!=e.defaultValue?String(e.defaultValue):""}}}else if("WidgetProperty"==e.sourceType&&""!=e.sourceValue){if(void 0!==e.sourceValue&&null!=e.sourceValue){var u=e.sourceValue.split(":");if(2==u.length&&null!=u[0]&&void 0!==u[0]&&null!=u[1]&&void 0!==u[1]){var v=u[0],g=u[1],p=this._arena.getWidgetById(v);null!=p&&(i=p.getPropertyValue(g))}else i=void 0!==e.defaultValue&&null!=e.defaultValue?String(e.defaultValue):""}else void 0!==e.defaultValue&&null!=e.defaultValue&&""!=e.sourceValue&&(i=String(e.defaultValue))}}return i}},{key:"_handleAction",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(void 0!==e){var i=!0,n=[],o=[];(void 0===e?"undefined":(0,$aZgrU._)(e))==="object"&&(void 0!==e.condition||void 0!==e.actions||void 0!==e.else_actions)?(void 0!==e.condition&&(i=this._evaluateCondition(e.condition)),n=e.actions||[],o=e.else_actions||[]):(void 0===e?"undefined":(0,$aZgrU._)(e))==="object"?(void 0!==e.conditions&&(i=this._evaluateConditions(e.conditions)),n=[e.action]):n=[e];var s=0;if(i)for(s=0;s<n.length;s++)this._handleAction_dispatch(n[s],t);else for(s=0;s<o.length;s++)this._handleAction_dispatch(o[s],t)}}},{key:"_handleAction_dispatch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=null,n=null,o=null,s=!1,a=!0;if("string"==typeof e){var l=/^(\w*):(\w*)(.*)$/.exec((0,$22UZT.default).trim(e));if(null!=l){i=l[1].toString(),n=l[2].toString();var r=l[3].toString(),u=n+r,o=[];if(r.length>0){u=n+(r=this._replaceMacroStrings(r));var c=r.match(/dataSource:\{[^}]*\}/gm);if(null!=c)for(var d=0;d<c.length;d++){var h=this._processDataSource(c[d]);r=r.replace(c[d],JSON.stringify(h))}u=n+r;var o=null,f=/,/gm;if((r=(r=(r=r.replace(/^\(|\)$/gm,"")).replace(/\\"/gm,"%escaped_double_quote%")).replace(/\\'/gm,"%escaped_single_quote%")).match(f)){o=[];for(var _=/"/gm,v=[];null!==_.exec(r);)v.push(_.lastIndex-1);v.push(r.length);var g=-1;for(f=/,/gm;null!==f.exec(r);)for(var p=f.lastIndex-1,d=0;d<v.length;){if(p<v[d]){d%2==0&&(o.push(r.substring(g+1,p)),g=p);break}d++}g<r.length&&o.push(r.substring(g+1))}else""!=r&&(o=[r]);if(null!=o)for(var d=0;d<o.length;d++)o[d]=o[d].replace(/^\s*"|"\s*$/gm,"").replace(/%escaped_double_quote%/gm,'"').replace(/%escaped_single_quote%/gm,"'");i&&"javascript"===i.toLowerCase()&&(n=u)}}}else{if(e.useContext){var m,y,b,w,k,S=null===(y=this._arena)||void 0===y?void 0:null===(m=y.instanceService)||void 0===m?void 0:m.getInstance("PublicAPI"),A=null==S?void 0:null===(b=S.getPlayoutData().context)||void 0===b?void 0:b.toLowerCase();if(!A&&(null===(w=e.contexts)||void 0===w?void 0:w.length)||A&&!(null===(k=e.contexts)||void 0===k?void 0:k.includes(A)))return}i=e.entity,n=e.command,o=e.parameters?e.parameters.map(function(e){return e.value}):[];for(var d=0;d<o.length;d++)if("string"==typeof o[d])o[d]=this._replaceMacroStrings(o[d]);else if(o[d]&&o[d].datasource){var $=o[d].datasource;if(!a&&$&&"DatafeedValue"===$.sourceType&&$.sourceValue&&-1!==$.sourceValue.indexOf(":")){var x=$.sourceValue.split(":")[0];x&&(!this._datafeeds[x]||"{}"===JSON.stringify(this._datafeeds[x]))?(this._asyncDatasourceDispatches[x]||(this._asyncDatasourceDispatches[x]=[]),-1===this._asyncDatasourceDispatches[x].indexOf(e)&&this._asyncDatasourceDispatches[x].push(e),this._datafeeds[x]||this._fetchDatafeed(x),s=!0):o[d]=this._processDataSource($)}else o[d]=this._processDataSource($)}i.match(/javascript/i)&&(n=o[0])}if((a||!s)&&i)switch(i.toLowerCase()){case"navigation":t||this._handleAction_navigation(n,o);break;case"player":t||this._handleAction_player(n,o);break;case"javascript":this._handleAction_javascript(n);break;case"widget":this._handleAction_widget(n,o);break;case"group":this._handleAction_group(n,o);break;case"form":this._handleAction_form(n,o);break;case"download":this._handleAction_download(n,o);break;case"localstorage":this._handleAction_localstorage(n,o);break;case"message":this._handleAction_message(n,o);break;case"analytics":this._handleAction_analytics(n,o)}}},{key:"_handleAction_navigation",value:function(e,t){if("string"==typeof e&&void 0!==t&&t.length>0){var i,n,o=t[0],s=t[1]||"_self",a=null===(n=this._arena)||void 0===n?void 0:null===(i=n.instanceService)||void 0===i?void 0:i.getInstance("PublicAPI");a?a.doOpenUrl(o,s):("_blank"===s&&(s=this._generateRandomTarget()),window.open(o,s,"noopener"))}}},{key:"_handleAction_player",value:function(e,t){if("string"==typeof e){var i=null===(u=this._arena)||void 0===u?void 0:null===(r=u.instanceService)||void 0===r?void 0:r.getInstance("PublicAPI");if(i)switch(e.toLowerCase()){case"play":i.play();break;case"pause":i.pause();break;case"mute":case"unmute":i.setMuted("mute"==e.toLowerCase(),!1,!0);break;case"programmute":case"programunmute":i.setProgramMuted("programmute"==e.toLowerCase());break;case"volume":void 0!==t&&t.length>0&&i.setVolume(parseFloat((0,$22UZT.default).trim(t[0])),!0);break;case"programvolume":void 0!==t&&t.length>0&&i.setProgramVolume(parseFloat((0,$22UZT.default).trim(t[0])));break;case"seek":void 0!==t&&t.length>0&&i.seek(parseFloat((0,$22UZT.default).trim(t[0])));break;case"seekchapter":if(void 0!==t&&t.length>0){var n=this._arena.getWidgetById((0,$22UZT.default).trim(t[0]));null!=n&&null!=n._inpoint&&i.seek(parseFloat(n._inpoint))}break;case"load":void 0!==t&&t.length>0&&i.load({clipId:(0,$22UZT.default).trim(t[0]),seekTo:parseFloat((0,$22UZT.default).trim(t[1])),autoPlay:!0,shouldPlayInline:!0,initiator:"Widget/"+this._entityId,useSession:this._useSession});break;case"loadproject":void 0!==t&&t.length>0&&i.load({projectId:(0,$22UZT.default).trim(t[0]),seekTo:parseFloat((0,$22UZT.default).trim(t[1])),autoPlay:!0,shouldPlayInline:!0,initiator:"Widget/"+this._entityId,useSession:this._useSession});break;case"fullscreen":i.fullscreen();break;case"retractfullscreen":i.retractFullscreen();break;case"show":void 0!==t&&t.length>0&&i.showInterfaceElement(t[0]);break;case"hide":void 0!==t&&t.length>0&&i.hideInterfaceElement(t[0]);break;case"enable":void 0!==t&&t.length>0&&i.enableInterfaceElement(t[0]);break;case"disable":void 0!==t&&t.length>0&&i.disableInterfaceElement(t[0]);break;case"showsubtitlelayer":"function"==typeof i.showSubtitleLayer?i.showSubtitleLayer():(0,$22UZT.default)(i.getSubtitleLayer()).show();break;case"hidesubtitlelayer":"function"==typeof i.hideSubtitleLayer?i.hideSubtitleLayer():(0,$22UZT.default)(i.getSubtitleLayer()).hide();break;case"togglefullscreen":i.toggleFullscreen();break;case"skipad":"function"==typeof i.skipAd&&i.skipAd();break;case"setsubtitle":if(void 0!==t&&t.length>0)for(var o=i.getSubtitlesList()||[],s=0;s<o.length;s++){var a=o[s];if(void 0!==a.isocode&&null!=a.isocode&&void 0!==a.id&&null!=a.id&&a.isocode==(0,$22UZT.default).trim(t[0])){i.setSubtitle(a.id);break}}break;case"setaudiotrack":if(void 0!==t&&t.length>0)for(var o=i.getAudioTracks()||[],s=0;s<o.length;s++){var l=o[s];if(void 0!==l.label&&null!=l.label&&void 0!==l.id&&null!=l.id&&l.label==(0,$22UZT.default).trim(t[0])){i.selectAudioTrack(l.id);break}}break;case"setaudiotrackbyiso":if(void 0!==t&&t.length>0)for(var o=i.getAudioTracks()||[],s=0;s<o.length;s++){var r,u,c,d,l=o[s];if(void 0!==l.isocode&&null!=l.label&&void 0!==l.id&&null!=l.id&&(null===(c=l.isocode)||void 0===c?void 0:c.toLowerCase())===(null===(d=(0,$22UZT.default).trim(t[0]))||void 0===d?void 0:d.toLowerCase())){i.selectAudioTrack(l.id);break}}break;case"sharebyemail":this._handleSharing("email");break;case"shareonfacebook":this._handleSharing("facebook");break;case"shareontwitter":this._handleSharing("twitter");break;case"shareonlinkedin":this._handleSharing("linkedin");break;case"shareonpinterest":this._handleSharing("pinterest");break;case"shareonwhatsapp":this._handleSharing("whatsapp")}}}},{key:"_handleSharing",value:function(e){var t,i,n=null===(i=this._arena)||void 0===i?void 0:null===(t=i.instanceService)||void 0===t?void 0:t.getInstance("PublicAPI");n&&n.doShare(e)}},{key:"_handleAction_javascript",value:function(e,t){if("string"==typeof e){var i,n,o=this._arena.getDisallowScripts();if(this._executer||(this._executer=null===(n=this._arena)||void 0===n?void 0:null===(i=n.instanceService)||void 0===i?void 0:i.getInstance("Executer")),!o&&null!=this._executer&&"function"==typeof this._executer.execute){var s=null;return void 0!==t&&(s=t.join(",")),this._executer.execute(e+(null!=s?"("+s+")":""))}}}},{key:"_handleAction_widget",value:function(e,t){if((0,$5rc4Z.default)("TimelineWidget: _handleAction_widget: "+e+" : "+t[0]),"string"==typeof e&&void 0!==t&&t.length>0){var i=this._arena.getWidgetById((0,$22UZT.default).trim(t[0]));if(i)switch(e.toLowerCase()){case"setproperty":i._setProperty(t);break;case"callmethod":i._callMethod(t);break;default:var n=t.concat();n.splice(1,0,e),i._callMethod(n)}}}},{key:"_audioFadeOut",value:function(e,t){if("function"==typeof e.setVolume&&"function"==typeof e.getVolume){var i=e.getVolume();if(null!=i)var n=.05,o=setInterval(function(){i>n?(i-=n,e.setVolume(i)):(e.setVolume(0),clearInterval(o))},1e3*t/(i/.05))}}},{key:"_audioFadeIn",value:function(e,t,i){if("function"==typeof e.setVolume)var n=0,o=.05,s=setInterval(function(){n+o<i?(n+=o,e.setVolume(n)):(e.setVolume(i),clearInterval(s))},1e3*t/(i/.05))}},{key:"_handleAction_group",value:function(e,t){if("string"==typeof e&&void 0!==t&&t.length>0){var i=this._arena.getGroupById((0,$22UZT.default).trim(t[0]));if(i)switch(e.toLowerCase()){case"setproperty":i.setProperty(t);break;case"callmethod":i.callMethod(t);break;default:var n=t.concat();n.splice(1,0,e),i.callMethod(n)}}}},{key:"_handleAction_form",value:function(e,t){if("string"==typeof e){var i="1";void 0!==t&&(0,$aZgrU._)(t.length)>0&&(i=(0,$22UZT.default).trim(t[0]));var n=this._arena.getWidgetById("form:"+i);if(null!=n){var o,s=null===(o=this._arena)||void 0===o?void 0:o.instanceService.getInstance(n.$element.data("timelineWidgetFormId"));null==s||s.post()}}}},{key:"_handleAction_localstorage",value:function(e,t){if("string"==typeof e&&void 0!==t&&t.length>0&&null!=t[0]&&void 0!==t[0])switch(e){case"setItem":if(this._localStorage&&null!=t[1]&&void 0!==t[1]){var i="string"==typeof t[1]&&t[1].substr(0,2);if("++"===i||"--"===i){var n=this._localStorage.get("bbtl_"+t[0]),o=n;(null==n||void 0===n)&&(n=0),"++"===i&&(o=parseFloat(n)+1),"--"===i&&(o=parseFloat(n)-1),this._localStorage.set("bbtl_"+t[0],o)}else this._localStorage.set("bbtl_"+t[0],t[1])}break;case"removeItem":this._localStorage&&this._localStorage.remove("bbtl_"+t[0]);break;case"setItemWithWidgetProperty":var s="",a=this._arena.getWidgetById((0,$22UZT.default).trim(t[1]));null!=a&&"function"==typeof a.getValue&&(s=a.getValue()),this._localStorage&&this._localStorage.set("bbtl_"+t[0],s)}}},{key:"_handleAction_message",value:function(e,t){if("string"==typeof e&&""!=e){var i;(0,$5rc4Z.default)("TimelineWidget: _handleAction_message: message = "+e),null===(i=this.$element)||void 0===i||i.trigger("bb_on_message",[{name:e,widgetId:this._entityId}])}}},{key:"_handleAction_analytics",value:function(e,t){if("string"==typeof e&&""!=e&&"logevent"==e&&((0,$5rc4Z.default)("TimelineWidget: _handleAction_analytics: data = "+e),t.length>1&&""!=t[0]&&""!=t[1])){var i,n=t[0]+":"+t[1];null===(i=this.$element)||void 0===i||i.trigger("bb_widget_custom_analytics",[{entityId:this._entityId,timelineId:this._timelineId,data:n}])}}},{key:"_handleAction_download",value:function(e,t){if("string"==typeof e&&void 0!==t&&t.length>0&&null!=t[0]&&void 0!==t[0]){var i=t[0];this._documentDownload(i)}}},{key:"_documentDownload",value:function(e){var t,i,n="https://bb.bbvms.com/documentDownload.php?id="+e;this._arena&&(n=this._arena._server+"/documentDownload.php?id="+e);var o=navigator.userAgent.toLowerCase().indexOf("crios")>-1,s=navigator.userAgent.toLowerCase().indexOf("chrome")>-1,a=navigator.userAgent.toLowerCase().indexOf("safari")>-1;if(!o&&(s||a)){var l=document.createElement("a");if(l.href=n,void 0!==l.download){var r="download-"+e;l.download=r}if("function"!=typeof MouseEvent)return window.bluebillywig._internal.Util.triggerEventOnJQueryObject((0,$22UZT.default)(l),"click"),!0;var u=new MouseEvent("click",{bubbles:!0,cancelable:!0});return l.dispatchEvent(u),!0}var c=null===(i=this._arena)||void 0===i?void 0:null===(t=i.instanceService)||void 0===t?void 0:t.getInstance("PublicAPI");c?c.doOpenUrl(n,"_blank"):window.open(n,"_blank","noopener")}},{key:"_performWidgetTransition",value:function(e){var t=this;if(this.$element){"function"==typeof this.$element.stop&&this.$element.stop(),null!=this._savedStyles&&(this.$element.css(this._savedStyles),this._savedStyles=null),void 0!==this.$element.get(0).style?this._savedStyles={left:this.$element.get(0).style.left,top:this.$element.get(0).style.top,opacity:this.$element.css("opacity")}:this._savedStyles={left:this.$element.css("left"),top:this.$element.css("top"),opacity:this.$element.css("opacity")};var i=this.$element.width(),n=this.$element.height(),o=this.$element.parent().width(),s=this.$element.parent().height(),a=isNaN(parseFloat(e[1]))?800:1e3*parseFloat(e[1]),l={transform:"translate(0, 0)",opacity:this._savedStyles.opacity},r={transform:"translate(0, 0)",opacity:this._savedStyles.opacity};switch(e[2]){case"Slide in from left":l.transform="translate(".concat("-"+(parseFloat(this.$element.css("left"))+i)+"px",", 0)");break;case"Slide in from right":l.transform="translate(".concat(o-parseFloat(this.$element.css("left"))+"px",", 0)");break;case"Slide in from top":l.transform="translate(0, ".concat("-"+(parseFloat(this.$element.css("top"))+n)+"px",")");break;case"Slide in from bottom":l.transform="translate(0, ".concat(s-parseFloat(this.$element.css("top"))+"px",")");break;case"Slide out to left":r.transform="translate(".concat("-"+(parseFloat(this.$element.css("left"))+i)+"px",", 0)");break;case"Slide out to right":r.transform="translate(".concat(o-parseFloat(this.$element.css("left"))+"px",", 0)");break;case"Slide out to top":r.transform="translate(0, ".concat("-"+(parseFloat(this.$element.css("top"))+n)+"px",")");break;case"Slide out to bottom":r.transform="translate(0, ".concat(s-parseFloat(this.$element.css("top"))+"px",")")}switch(e[3]){case"fade in":l.opacity="0.0",r.opacity="1.0";break;case"fade out":r.opacity="0.0"}var u="linear";switch(e[4]){case"lineair":case"linear":u="linear";break;case"easeInExpo":case"easeOutExpo":case"easeInBounce":case"easeOutBounce":case"exponential":u="ease-in-out"}this.$element.data("styles",r);var c=this.$element.get(0);if("function"==typeof(null==c?void 0:c.animate)){var d={transform:"".concat(l.transform),opacity:"".concat(l.opacity)},h={transform:"".concat(r.transform),opacity:"".concat(r.opacity)},f={duration:a,iterations:1,easing:u};-1===e[2].indexOf("out")&&-1===e[3].indexOf("out")?("image"===this._type&&this.$element.css("visibility","visible"),this.show(),c.animate([d,h],f).finished.then(function(){return t._handleWidgetTransitionInDone()})):c.animate([d,h],f).finished.then(function(){return t._handleWidgetTransitionOutDone()})}else -1===e[2].indexOf("out")&&-1===e[3].indexOf("out")?(this.$element.css(l),"image"===this._type&&this.$element.css("visibility","visible"),this.show(),window.setTimeout(function(){t.$element.css(r),t._handleWidgetTransitionInDone()},a)):(this.$element.css(l),window.setTimeout(function(){t.$element.css(r),t._handleWidgetTransitionOutDone()},a))}}},{key:"_performWidgetCustomTransition",value:function(e){var t=this;if(this.$element){"function"==typeof this.$element.stop&&this.$element.stop();var i={};(i=void 0!==this.$element.get(0).style?{left:this.$element.get(0).style.left,top:this.$element.get(0).style.top,opacity:this.$element.css("opacity")}:{left:this.$element.css("left"),top:this.$element.css("top"),opacity:this.$element.css("opacity")}).width=this.$element.width()+"px",i.height=this.$element.height()+"px";var n=isNaN(parseFloat(e[1]))?800:1e3*parseFloat(e[1]),o={left:i.left,top:i.top,opacity:i.opacity,width:i.width,height:i.height},s={left:i.left,top:i.top,opacity:i.opacity,width:i.width,height:i.height};switch(this._savedStyles={},s.left=this._savedStyles.left=e[2],s.top=this._savedStyles.top=e[3],s.width=this._savedStyles.width=e[4],s.height=this._savedStyles.height=e[5],e[6]){case"fade in":o.opacity="0.0",s.opacity="1.0";break;case"fade out":s.opacity="0.0"}var a="linear";switch(e[7]){case"lineair":case"linear":a="linear";break;case"easeInExpo":case"easeOutExpo":case"easeInBounce":case"easeOutBounce":case"exponential":a="ease-in-out"}this.$element.data("styles",s);var l=this.$element.get(0);if("function"==typeof(null==l?void 0:l.animate)){var r={left:"".concat(o.left),top:"".concat(o.top),opacity:"".concat(o.opacity),width:"".concat(o.width),height:"".concat(o.height)},u={left:"".concat(s.left),top:"".concat(s.top),opacity:"".concat(s.opacity),width:"".concat(s.width),height:"".concat(s.height)},c={duration:n,iterations:1,easing:a,fill:"forwards"};-1===e[6].indexOf("out")?("image"===this._type&&this.$element.css("visibility","visible"),this.show(),l.animate([r,u],c).finished.then(function(){return t._handleWidgetTransitionInDone()})):l.animate([r,u],c).finished.then(function(){return t._handleWidgetTransitionOutDone()})}else -1===e[6].indexOf("out")?(this.$element.css(o),"image"===this._type&&this.$element.css("visibility","visible"),this.show(),window.setTimeout(function(){t.$element.css(s),t._handleWidgetTransitionInDone()},n)):(this.$element.css(o),window.setTimeout(function(){t.$element.css(s),t._handleWidgetTransitionOutDone()},n))}}},{key:"_handleWidgetTransitionInDone",value:function(){if(null!=this._savedStyles&&this.$element.css(this._savedStyles),this._savedStyles=null,"array"===(0,$aZgrU._)(this._ontransitionDoneActions)||"object"===(0,$aZgrU._)(this._ontransitionDoneActions))for(var e in this._ontransitionDoneActions)parseInt(e)>=0&&this._handleAction(this._ontransitionDoneActions[e])}},{key:"_handleWidgetTransitionOutDone",value:function(){if(this.hide(),null!=this._savedStyles&&this.$element.css(this._savedStyles),"array"===(0,$aZgrU._)(this._ontransitionDoneActions)||"object"===(0,$aZgrU._)(this._ontransitionDoneActions))for(var e in this._ontransitionDoneActions)parseInt(e)>=0&&this._handleAction(this._ontransitionDoneActions[e])}},{key:"_setProperty",value:function(e){if(void 0!==e[1]&&null!=e[1]&&void 0!==e[2]&&null!=e[2]){var t={};e[1].indexOf("/")>-1?TimelineWidget._expandComplexKey(e[1],e[2],null,t):t[e[1]]=e[2],this._updateInitialConfig(t),this.update(t)}}},{key:"_updateInitialConfig",value:function(e){var t,i,n,o,s=JSON.parse(this._initialConfigJSON);e&&(null==s?void 0:null===(o=s.statesets)||void 0===o?void 0:null===(n=o[0])||void 0===n?void 0:null===(i=n.states)||void 0===i?void 0:null===(t=i[0])||void 0===t?void 0:t.config)&&(s.statesets[0].states[0].config=(0,$dogxk._)({},s.statesets[0].states[0].config,e),this._initialConfigJSON=JSON.stringify(s))}},{key:"_callMethod",value:function(e){if(void 0!==e[1]&&null!==e[1]){var t=e[1],i=[].concat(e);if(t.indexOf(":")>-1){var n=t.split(":");i[1]=t=n[0],i.splice(2,0,n[1])}if(i.splice(0,1),"string"==typeof t&&void 0!==i&&i.length>0)switch(t.toLowerCase()){case"setproperty":this._setProperty(i);break;case"show":this.show();break;case"hide":this.hide();break;case"restoreinitialconfig":this.restoreInitialConfig();break;case"toggleimage":"function"==typeof this.toggleContent&&this.toggleContent();break;case"transition":i.length>1&&this._performWidgetTransition(i);break;case"customtransition":i.length>1&&this._performWidgetCustomTransition(i);break;case"pause":"function"==typeof this.pause&&this.pause();break;case"resume":case"play":"function"==typeof this.resume&&this.resume();break;case"seek":"function"==typeof this.seek&&i.length>1&&""!=i[1]&&this.seek(Number(i[1]));break;case"mute":"function"==typeof this.mute&&this.mute();break;case"unmute":"function"==typeof this.unmute&&this.unmute();break;case"setvolume":"function"==typeof this.setVolume&&i.length>1&&""!=i[1]&&this.setVolume(Number(i[1])/100);break;case"volumetransition":i.length>2&&""!=i[1]&&""!=i[2]&&("fade out"==i[2]?this._audioFadeOut(this,i[1]):"fade in"==i[2]&&""!=i[3]&&this._audioFadeIn(this,i[1],i[3]/100));break;case"setvalue":i.length>1&&null!=i[1]&&("function"==typeof this.setValue?this.setValue(i[1]):""!=i[1]&&this.update({value:i[1]}));break;case"start":"function"==typeof this.start&&this.start();break;case"stop":"function"==typeof this.stop&&this.stop();break;case"reset":"function"==typeof this.reset&&this.reset()}}}},{key:"_generateRandomTarget",value:function(){var e=new Date;return(Math.random().toString()+"_"+e.getTime()).replace(/[-.\s]/g,"")}},{key:"_evaluateConditions",value:function(e){var t={},i=[],n="";for(var o in e)if("expression"!=o){i.push(o);var s=/^(\w*):(.*)$/.exec((0,$22UZT.default).trim(e[o]));if(s&&s.length>2){var a=s[1].toString();s[2]=this._replaceMacroStrings(s[2]);var l=s[2].match(/dataSource:\{[^}]*\}/gm);if(null!=l)for(var r=0;r<l.length;r++)s[2]=s[2].replace(l[r],this._processDataSource(l[r]));switch(a.toLowerCase()){case"widget":t[o]=this._evaluateCondition_widget(s[2]);break;case"player":t[o]=this._evaluateCondition_player(s[2]);break;case"localstorage":t[o]=this._evaluateCondition_localstorage(s[2]);break;case"compare":t[o]=this._evaluateCondition_compare(s[2])}}else t[o]=!1}else n=e[o];return""==n&&(n=i.join(" AND ")),this._evaluateExpression(n,t)}},{key:"_evaluateCondition",value:function(e){var t=!0;if(e&&e.variables&&e.variables.length>0){for(var i={},n=[],o=e.expression,s=0;s<e.variables.length;s++){var a=e.variables[s],l=a.name;if(n.push(l),a.rule){var r=(0,$22UZT.default).extend({},a.rule);if(r.lvalue){if("string"==typeof r.lvalue)r.lvalue=this._replaceMacroStrings(r.lvalue);else{var u=r.lvalue.datasource?r.lvalue.datasource:r.lvalue;r.lvalue=this._processDataSource(u)}}if(r.rvalue){if("string"==typeof r.rvalue)r.rvalue=this._replaceMacroStrings(r.rvalue);else{var c=r.rvalue.datasource?r.rvalue.datasource:r.rvalue;r.rvalue=this._processDataSource(c)}}switch(a.entityType){case"widget":i[l]=this._evaluateRule_widget(r,a.entityId);break;case"player":i[l]=this._evaluateRule_player(r,a.entityId);break;case"localstorage":i[l]=this._evaluateRule_localstorage(r);break;case"compare":i[l]=this._evaluateRule_compare(r)}}}o||(o=n.join(" AND ")),t=this._evaluateExpression(o,i)}return t}},{key:"_evaluateRule_widget",value:function(e,t){var i=!1;if(e){var n=this._arena.getWidgetById(t);null!=n?e.lvalue=n.getPropertyValue(e.lvalue):e.lvalue="visible"==e.lvalue||"toggled"==e.lvalue||"playing"==e.lvalue||"valid"==e.lvalue?"false":null,i=this._evaluateRule(e)}return i}},{key:"_evaluateRule_player",value:function(e,t){var i=!1;if(e){var n,o,s=null;(s=t?window.bluebillywig.getPlayerInstance(t):null===(o=this._arena)||void 0===o?void 0:null===(n=o.instanceService)||void 0===n?void 0:n.getInstance("PublicAPI"))&&(e.lvalue=s.getPropertyValue(e.lvalue),i=this._evaluateRule(e))}return i}},{key:"_evaluateRule_localstorage",value:function(e){var t=!1;return e&&(e.lvalue=this._localStorage?this._localStorage.get("bbtl_"+e.lvalue):null,t=this._evaluateRule(e)),t}},{key:"_evaluateRule_compare",value:function(e){var t=!1;return e&&(t=this._evaluateRule(e)),t}},{key:"_evaluateCondition_widget",value:function(e){var t=!1,i=/(.*)\((.*)\)/.exec(e);if(null!=i){var n=(0,$22UZT.default).trim(i[1]),o=String(i[2]).split(",");o[1]=String(o[1]).replace(":","==");var s=(0,$22UZT.default).trim(o[1]).match(/(.*[^><!=~])(==|!=|~=|<|<=|>|>=)([^><!=~].*)/);if(null!=s&&s.length>3){var a={lvalue:s[1],operator:s[2],rvalue:s[3]};n.toLowerCase();var l=this._arena.getWidgetById(o[0].toLowerCase());null!=l?a.lvalue=l.getPropertyValue(a.lvalue):a.lvalue="visible"==a.lvalue||"toggled"==a.lvalue||"playing"==a.lvalue||"valid"==a.lvalue?"false":null,t=this._evaluateRule(a)}}return t}},{key:"_evaluateCondition_player",value:function(e){var t,i,n=!1,o=null===(i=this._arena)||void 0===i?void 0:null===(t=i.instanceService)||void 0===t?void 0:t.getInstance("PublicAPI"),s=/(.*)\((.*)\)/.exec(e);if(null!=s){var a=(0,$22UZT.default).trim(s[1]),l=String(s[2]).split(",");l[1]=String(l[1]).replace(":","==");var r=(0,$22UZT.default).trim(l[1]).match(/(.*[^><!=~])(==|!=|~=|<|<=|>|>=)([^><!=~].*)/);if(null!=r&&r.length>3){var u={lvalue:r[1],operator:r[2],rvalue:r[3]};a.toLowerCase(),u.lvalue=null==o?void 0:o.getPropertyValue(u.lvalue),n=this._evaluateRule(u)}}return n}},{key:"_evaluateCondition_localstorage",value:function(e){var t=!1,i=/(.*)\((.*)\)/.exec(e);if(null!=i){var n=(0,$22UZT.default).trim(i[1]),o=String(i[2]).split(",");o[1]=String(o[1]).replace(":","==");var s=(0,$22UZT.default).trim(o[1]).match(/(.*[^><!=~])(==|!=|~=|<|<=|>|>=)([^><!=~].*)/);if(null!=s&&s.length>3){var a={lvalue:s[1],operator:s[2],rvalue:s[3]};n.toLowerCase(),a.lvalue=this._localStorage?this._localStorage.get("bbtl_"+a.lvalue):null,t=this._evaluateRule(a)}}return t}},{key:"_evaluateCondition_compare",value:function(e){var t=!1,i=/(.*)\((.*)\)/.exec(e);if(null!=i){var n=(0,$22UZT.default).trim(i[1]),o=String(i[2]).split(",");o[1]=String(o[1]).replace(":","==");var s=(0,$22UZT.default).trim(o[1]).match(/(.*[^><!=~])(==|!=|~=|<|<=|>|>=)([^><!=~].*)/);if(null!=s&&s.length>3){var a={lvalue:s[1],operator:s[2],rvalue:s[3]};n.toLowerCase(),t=this._evaluateRule(a)}}return t}},{key:"_evaluateRule",value:function(e){if(null!=e)switch(e.operator){default:case"==":return String(e.lvalue)==String(e.rvalue);case"!=":return String(e.lvalue)!=String(e.rvalue);case"contains":return String(e.lvalue).toLowerCase().indexOf(String(e.rvalue).toLowerCase())>=0;case"doesNotContain":return 0>String(e.lvalue).toLowerCase().indexOf(String(e.rvalue).toLowerCase());case">=":return parseFloat(e.lvalue)>=parseFloat(e.rvalue);case">":return parseFloat(e.lvalue)>parseFloat(e.rvalue);case"<=":return parseFloat(e.lvalue)<=parseFloat(e.rvalue);case"<":return parseFloat(e.lvalue)<parseFloat(e.rvalue)}return!1}},{key:"getPropertyValue",value:function(e){if(void 0===e||null==e)return!1;if(null==e?void 0:e.startsWith("stats_"))return this._getStatsMetric(e.substring(6));var t=null,i=e.toString().split(".");if(null!=i&&i.length>0)switch(i[0]){case"valid":"function"==typeof this.isValid&&(t=this.isValid());break;case"value":"function"==typeof this.getValue&&(t=this.getValue());break;case"running":"function"==typeof this.isRunning&&(t=this.isRunning());break;case"visible":void 0!==this._isCurrentlyShown&&(t=this._isCurrentlyShown);break;case"toggled":"function"==typeof this.isToggled&&(t=this.isToggled());break;case"playing":"function"==typeof this.isPlaying&&(t=this.isPlaying());break;default:i.length>1&&"function"==typeof this.getPropertyValue&&(t=this.getPropertyValue(e))}return t}},{key:"_getStatsMetric",value:function(e){var t,i,n=null===(i=this._sharedDataService)||void 0===i?void 0:null===(t=i.getWidgetStats)||void 0===t?void 0:t.call(i,this._entityId);return(null==n?void 0:n[e])||0}},{key:"_evaluateExpression",value:function _evaluateExpression(expression,variables){var ret=!1;for(var key in expression=expression.replace(/AND/g,"&&").replace(/OR/g,"||"),variables){var keyRe=RegExp(key,"g"),value="true"===variables[key]||!0===variables[key]||1===variables[key];expression=expression.replace(keyRe,value.toString())}var match_open=expression.match(/\(/g),count_open=null!=match_open?match_open.length:0,match_closed=expression.match(/\)/g),count_closed=null!=match_open?match_closed.length:0,match_exclusive=expression.replace(/&&/g,"").replace(/\|\|/g,"").replace(/true/g,"").replace(/false/g,"").match(/^[()\s]*$/);if(null!=match_exclusive&&match_exclusive.length>0&&count_closed==count_open)try{ret=eval(expression)}catch(err){"undefined"!=typeof console&&console.log("Notice: there was an error executing the javascript by evaluateExpression. Expression was: "+expression)}return ret}},{key:"_replaceMacroStrings",value:function(e){var t=null===(d=this._arena)||void 0===d?void 0:null===(c=d.instanceService)||void 0===c?void 0:c.getInstance("PublicAPI"),i=e?String(e).match(/{{\s*[\w\.]+\s*}}/g):null;if(null!=i)for(var n=i.map(function(e){return e.match(/[\w\.]+/)[0]}),o=0;o<n.length;o++){var s=n[o].split(".");if(s.length>1){switch(s[0]){case"mediaclip":if(void 0!==t&&null!=t){var a=t.getClipData();null!=a&&(r=a[s[1]])}break;case"asset":var l=t.getCurrentAsset();null!=l&&(r=l[s[1]]);break;case"player":var r=t.getPropertyValue(s[1]);break;case"playout":var r=t.getPlayoutData()[s[1]];break;case"localstorage":if(this._localStorage){var u=this._localStorage.get("bbtl_"+s[1]);void 0!==u&&null!=u?("string"==typeof u&&(u=u.replace(",","&comma;")),r=u):r=""}else r="";break;case"querystring":if(this._opts.joinedRequestParams){var c,d,r,h,f=this._opts.joinedRequestParams[String(s[1])];if(null!=f&&void 0!==f&&""!=f){try{var _=atob(f),v=Uint8Array.from(_,function(e){return e.codePointAt(0)});h=new TextDecoder().decode(v)}catch(e){}r=f.length%4==0&&null!=h&&void 0!==h?h:f}else r=""}}(void 0===r||null==r)&&(r=""),e=e.replace("{{"+n[o]+"}}",r)}}return e}},{key:"_onResized",value:function(e){null!=this.lastConfigForTranslation&&this.update(this.lastConfigForTranslation)}},{key:"getAbsoluteValueFromWidth",value:function(e){if(e.indexOf("%")>=0&&void 0!==this.$element.parent&&void 0!==this.$element.parent().width)return this.$element.parent().width()/100*e.substring(0,e.indexOf("%"))}},{key:"getAbsoluteValueFromHeight",value:function(e){if(e.indexOf("%")>=0&&void 0!==this.$element.parent&&void 0!==this.$element.parent().height)return this.$element.parent().height()/100*e.substring(0,e.indexOf("%"))}},{key:"getLinesIntersectionPoint",value:function(e,t,i,n,o,s,a,l){var r,u,c,d,h,f={x:null,y:null};return 0==(r=(l-s)*(i-e)-(a-o)*(n-t))||(u=t-s,c=e-o,d=(a-o)*u-(l-s)*c,h=(i-e)*u-(n-t)*c,u=d/r,c=h/r,f.x=e+u*(i-e),f.y=t+u*(n-t)),f}}],[{key:"_getConfig",value:function(e,t,i){var n=!1;if(void 0===t&&(t="default"),void 0===i&&(i="default"),void 0!==e.statesets){for(var o=0;o<e.statesets.length&&e.statesets[o].name!==t;)o++;if(o<e.statesets.length){var s=e.statesets[o];if(void 0!==s.states){for(var a,l=0;l<s.states.length&&("default"===s.states[l].name&&(a=s.states[l].config),s.states[l].name!==i);)l++;if(l<s.states.length){var r=s.states[l];n="default"!==i&&a?Object.assign({},a,r.config):r.config}}}}else n=e;if(e.apps){for(var u=0;u<e.apps.length&&(!e.apps[u]||e.apps[u].id!==n.appid);)u++;u<e.apps.length&&(n.app=e.apps[u])}return e.grouping&&(n.grouping=e.grouping),n}},{key:"hexToRgba",value:function(e,t){var i=[],n=parseInt(e,16);return isNaN(parseFloat(t))&&(t="100%"),i[0]=Math.floor(n/65536),n-=65536*i[0],i[1]=Math.floor(n/256),n-=256*i[1],i[2]=Math.floor(n),i[3]=parseFloat(t)/100,"rgba("+i.join(",")+")"}},{key:"_expandComplexKey",value:function(e,t,i,n){var o=e.split("/");i&&"object"===(0,$aZgrU._)(i[o[0]])&&(n[o[0]]=JSON.parse(JSON.stringify(i[o[0]])));for(var s=n,a=0,l=o.length;a<l-1;a++)"object"!==(0,$aZgrU._)(s[o[a]])&&(s[o[a]]={}),s=s[o[a]];if(s[o[o.length-1]]=t,"font"===o[o.length-1]&&t){var r=t.indexOf(";");r>-1&&(s.embeddedfont=t.substring(0,r),s.font=t.substring(r+1))}}}]),TimelineWidget}()}),parcelRegister("eIjVp",function(e,t){$parcel$export(e.exports,"default",function(){return f});var i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]];return{rows:e.length,columns:e.reduce(function(e,t){return Math.max(e,t.length)},0)}},n=function(e){var t=i(e);return t.rows===t.columns},o=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,i=[],n=0;n<e;n++){i[n]=[];for(var o=0;o<t;o++)i[n][o]=0}return i},s=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=o(e,t),s=Math.min(e,t),a=0;a<s;a++)n[a][a]=i;return n},a=function(e){for(var t=[],i=0;i<e.length;i++)t[i]=Array.isArray(e[i])?a(e[i]):e[i];return t},l=function(e){for(var t=a(e),n=i(t),o=n.rows,s=n.columns,l=[],r=0;r<o;r++)l[r]=r;for(var u=1,c=[],h=0;h<s;h++){for(var f=0;f<o;f++)c[f]=t[f][h];for(var _=0;_<o;_++){for(var v=Math.min(_,h),g=0,p=0;p<v;p++)g+=t[_][p]*c[p];c[_]-=g,t[_][h]=c[_]}for(var m=h,y=h+1;y<o;y++)Math.abs(c[y])>Math.abs(c[m])&&(m=y);if(m!==h){for(var b=0;b<s;b++){var w=t[m][b];t[m][b]=t[h][b],t[h][b]=w}var k=l[m];l[m]=l[h],l[h]=k,u=-u}if(h<o&&0!==t[h][h])for(var S=h+1;S<o;S++)t[S][h]=t[S][h]/t[h][h]}var A=function(){for(var e=0;e<s;e++)if(0===t[e][e])return!0;return!1},$=function(e){var n=i(e),a=n.rows,r=n.columns;if(o!==a)throw Error("Invalid matrix dimensions");if(A())throw Error("LU matrix is singular");for(var u=d(e,l,0,r-1),c=0;c<s;c++)for(var h=c+1;h<s;h++)for(var f=0;f<r;f++)u[h][f]=u[h][f]-u[c][f]*t[h][c];for(var _=s-1;_>=0;_--){for(var v=0;v<r;v++)u[_][v]=u[_][v]/t[_][_];for(var g=0;g<_;g++)for(var p=0;p<r;p++)u[g][p]=u[g][p]-u[_][p]*t[g][_]}return u};return{lu:t,pivotVector:l,pivotSign:u,solve:$}},r=function(e,t){if(!n(e))throw Error("Matrix is not square");return l(e).solve(t)},u=function(e){return r(e,s(i(e).rows))},c=function(e,t){for(var n=i(e),o=[],s=0;s<n.rows;s++)for(var a=0;a<n.columns;a++)o[s]=o[s]||[],o[s][a]=e[s][a]*(t[s]||0);return o},d=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i(e).columns-1,s=i(e).rows,a=[],l=0;l<t.length;l++){a[l]=[];for(var r=n;r<=o;r++){if(t[l]<0||t[l]>=s)throw RangeError("Row index out of range: ".concat(t[l]));a[l][r-n]=e[t[l]][r]}}return a},h=function(e,t){for(var n=i(e),o=[],s=0;s<n.rows;s++)o[s]=e[s][t]||0;return o},f={inspect:i,isSquare:n,zeros:o,identity:s,clone:a,luDecomposition:l,inverse:u,multiplyVector:c,subMatrixRow:d,getColumn:h}})}();
//# sourceMappingURL=TimelineWidget.8bc92c0e.js.map

//# debugId=6433d061-47b6-54c9-a38b-ec5995d4e060
